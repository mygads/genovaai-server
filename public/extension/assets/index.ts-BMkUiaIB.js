(function(){const p=".genovaai-bubble{position:fixed;z-index:999999;padding:12px 20px;border-radius:8px;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,sans-serif;font-size:14px;line-height:1.5;box-shadow:0 4px 12px #0000004d;max-width:400px;word-wrap:break-word;cursor:pointer;opacity:0;transform:translateY(10px);transition:all .3s ease-in-out;pointer-events:auto}.genovaai-bubble.show{opacity:1;transform:translateY(0)}.genovaai-bubble.position-bl{bottom:20px;left:20px}.genovaai-bubble.position-br{bottom:20px;right:20px}.genovaai-bubble.position-tl{top:20px;left:20px}.genovaai-bubble.position-tr{top:20px;right:20px}.genovaai-bubble:hover{box-shadow:0 6px 16px #0006;transform:translateY(-2px)}.genovaai-bubble.loading{display:flex;align-items:center;gap:10px}.loading-spinner{width:16px;height:16px;border:2px solid rgba(255,255,255,.3);border-top-color:currentColor;border-radius:50%;animation:spin .8s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}",f="genovaai-bubble-container",b="genovaai_bubble_preferences",x={position:"bl",bgColor:"#000000",textColor:"#ffffff",bgTransparent:!1,duration:3e3};let n=null,i=null,s=null,r=x;async function y(){try{const e=await chrome.storage.local.get(b);e[b]&&(r=e[b],console.log("✅ Bubble preferences loaded:",r))}catch(e){console.error("❌ Error loading bubble preferences:",e)}}y();function c(){if(i)return i;n=document.createElement("div"),n.id=f,n.style.position="fixed",n.style.zIndex="2147483647",n.style.pointerEvents="none",i=n.attachShadow({mode:"open"});const e=document.createElement("style");return e.textContent=p,i.appendChild(e),document.body.appendChild(n),i}chrome.runtime.onMessage.addListener((e,o,a)=>e.type==="GENOVA_RESULT"&&e.answer?(l(e.answer,!1),a({success:!0}),!0):e.type==="GENOVA_ERROR"&&e.error?(l("Error",!0),a({success:!0}),!0):e.type==="GENOVA_LOADING"?(g(),a({success:!0}),!0):e.type==="AUTH_ERROR"?(l(e.message||"Session expired. Please login again.",!0),a({success:!0}),!0):e.type==="LOGOUT"?(l("You have been logged out.",!1),a({success:!0}),!0):e.answer?(l(e.answer,e.type==="error"),a({success:!0}),!0):!1);function g(){u();const e=c(),o=document.createElement("div");o.className="genovaai-bubble loading",o.innerHTML='<div class="loading-spinner"></div>',r.bgTransparent?(o.style.backgroundColor="transparent",o.style.border="none",o.style.boxShadow="none",o.style.backdropFilter="none"):o.style.backgroundColor=r.bgColor,o.style.color=r.textColor,o.classList.add(`position-${r.position}`),e.appendChild(o),n&&(n.style.pointerEvents="auto"),requestAnimationFrame(()=>{o.classList.add("show")})}function l(e,o=!1){u();const a=c(),t=document.createElement("div");t.className="genovaai-bubble",o&&t.classList.add("error"),t.textContent=e,r.bgTransparent?(t.style.backgroundColor="transparent",t.style.border="none",t.style.boxShadow="none",t.style.backdropFilter="none"):t.style.backgroundColor=r.bgColor,t.style.color=r.textColor,o&&(t.style.border="2px solid #dc2626",t.style.boxShadow="0 4px 12px rgba(220, 38, 38, 0.3)"),t.classList.add(`position-${r.position}`),a.appendChild(t),n&&(n.style.pointerEvents="auto"),requestAnimationFrame(()=>{t.classList.add("show")}),s=window.setTimeout(()=>{d()},r.duration),t.addEventListener("click",d)}function d(){if(!i)return;const e=i.querySelector(".genovaai-bubble");e&&(e.classList.remove("show"),setTimeout(()=>{u()},300))}function u(){if(s&&(clearTimeout(s),s=null),i){const e=i.querySelector(".genovaai-bubble");e&&e.remove()}n&&(n.style.pointerEvents="none")}console.log("GenovaAI Content Script loaded");
})()
